# **儿童手表通信协议**  
    
# 一.说明  
- 该协议中所有数据都按照“LENGTH厂商*设备ID *内容”格式,“厂商”由ASCII码组成，以区分不同厂商的手表，由服务器分配，“设备ID”为15个数字，需要在服务器上注册的设备ID才可以正常工作， “内容长度LENGTH”固定为四个字节的HEX码,高位在前低位在后,例如FFFF表示长度为65535.“内容”根据指令的不同格式不一样。 
        
# 二.终端发送指令      
## 1.链路保持       
- 终端发送  
LENGTHCS\*YYYYYYYYYY\*LK       
实例:`0015CS*123456789012345*LK`        
- 平台回复      
LENGTHCS\*YYYYYYYYYY\*LK       
实例:`0015CS*123456789012345*LK`        
- 说明:链路保持数据5分钟发一次,若终端未收到回复数据,则5分钟重新连接一次.这个链路保持时间可以根据贵司的实际经验进行修改，目的是保持手表和服务器的连接.
    
## 2.位置数据上报     
- 终端发送:        
LENGTHCS\*YYYYYYYYYY\*UD,位置数据(查看基础数据上报)      
实例:        
`00E7CS*123456789012345*UD,220414,134652,A,22.571707,N,113.8613968,E,0.39,213.9,100,7,60,90,1000,00010000,4,1,460,02,9360,4082,131,9360,4092,148,9360,4091,143,9360,4153,141,2,TP-LINK1,1c:fa:68:13:a5:b4,-61,TP-LINK2,1c:fa:68:13:a5:b4,-55`    
- 平台回复:        
无      
说明:终端按照设定间隔上报位置和状态信息,不需要平台回复.       
    
## 3.盲点补传数据     
- 终端发送:        
LENGTHCS\*YYYYYYYYYY\*UD2 位置数据 (同上)       
- 平台回复:        
无       
说明:补传未登陆平台是产生的上报数据      
    
## 4.获取天气   
- 终端发送:        
LENGTHCS\*YYYYYYYYYY\*WEATHER, GPS数据,基站个数,MCC国家码,MNC网号,基站数据,WIFI数据(数据格式参考附录一)注:不包含方向,速度等信息 
实例:        
`0039CS*123456789012345*WEATHER,V,40.090271,116.3689728,2,460,0,4417,22004,131,4417,54526,114 `       
- 平台回复:        
LENGTHCS\*YYYYYYYYYY\*WEATHER,1 代表平台收到终端获取天气请求      
平台处理完天气数据下发给终端
实例:`001FCS*123456789012345*WEATHER,30,1 `     
(暂无数据)实例:`001FCS*123456789012345*WEATHER,2`
终端回复
LENGTHCS\*YYYYYYYYYY\*WEATHER,1 代表终端收到平台获取天气数据
说明:终端向平台请求天气数据,平台回复当前天气数据   
0— 晴       
1— 多云      
2— 阴       
3— 雨(包含雨夹雪类天气)       
4— 暴雨
5—雪 
        
## 5.报警数据上报 
- 终端发送:         
`LENGTHJL*YYYYYYYYYY*AL`,位置数据(查看基础数据上报)       
实例:         
`00E7JL*123456789012345*AL,220414,134652,A,22.571707,N,113.8613968,E,0.39,213.9,100,7,60,90,1000,00010000,4,1,460,02,9360,4082,131,9360,4092,148,9360,4091,143,9360,4153,141,2,TP-LINK1,1c:fa:68:13:a5:b4,-61,TP-LINK2,1c:fa:68:13:a5:b4,-55` 
- 平台回复:         
无       

 
    
# 三.平台发送指令
## 1.数据上传间隔设置
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*UPLOAD,时间间隔        
实例:`001CCS*123456789012345*UPLOAD,10`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*UPLOAD       
实例:`0019CS*123456789012345*UPLOAD`       
说明:设置终端定时上报的时间间隔.
    
## 2.中心号码设置
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*CENTER,中心号码      
实例:`0025CS*123456789012345\*CENTER,00000000000`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*CENTER       
实例:`0019CS*123456789012345*CENTER `      
说明:设置中心号码,通过该手机号码可发送短信指令.
    
## 3.辅助中心号码设置
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*SLAVE,辅助中心号码       
实例:`0024CS*123456789012345*SLAVE,00000000000`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*SLAVE        
实例:`0018CS*123456789012345*SLAVE`        
说明:设置辅助中心号码,通过该手机号码可发送短信指令.  
    
## 4.控制密码设置
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*PW,密码      
实例:`001CCS*123456789012345*PW,111111`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*PW       
实例:`0015CS*123456789012345*PW  `     
说明:设置终端密码,非中心号码发送短信指令需添加密码.
    
## 5.拨打电话
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*CALL,电话号码        
实例:`0023CS*123456789012345*CALL,00000000000`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*CALL        
实例:`0017CS*123456789012345*CALL`       
说明:通过该指令拨打相应手机号.
    
## 6.发送短信
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*SMS,短信号码,短信内容        
实例:`0029CS*123456789012345*SMS,00000000000,123ABC大家好`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*SMS         
实例:`0016CS*123456789012345*SMS`        
说明:通过该指令向相应手机号转发短信,短信内容采用GB232编码发送. 
    
## 7.监听
- 平台发送:        
LENGTHJL\*YYYYYYYYYY\*MONITOR        
实例:`001AJL*123456789012345*MONITOR`
- 终端回复:        
LENGTHJL\*YYYYYYYYYY\*MONITOR        
实例: `001AJL*123456789012345*MONITOR`       
说明:终端自动回拨中心号码
    
## 8.SOS号码设置
- (1) 第1个SOS号码设置       
平台发送:        
LENGTHCS\*YYYYYYYYYY\*SOS1,电话号码        
实例:`0023CS*123456789012345*SOS1,00000000000`       
终端回复:        
LENGTHCS\*YYYYYYYYYY\*SOS1       
实例:`0017CS*123456789012345*SOS1` 
- (2) 第2个SOS号码设置       
平台发送:        
LENGTHCS\*YYYYYYYYYY\*SOS2,电话号码        
实例:`0023CS*123456789012345*SOS2,00000000000`       
终端回复:        
LENGTHCS\*YYYYYYYYYY\*SOS2       
实例: `0017CS*123456789012345*SOS2`
- (3) 第3个SOS号码设置       
平台发送:        
LENGTHCS\*YYYYYYYYYY\*SOS3,电话号码      
实例: `0023CS*123456789012345*SOS3,00000000000`        
终端回复:        
LENGTHCS\*YYYYYYYYYY\*SOS3       
实例: `0017CS*123456789012345*SOS3`
- (4) 3个SOS号码同时设置      
平台发送:        
LENGTHCS\*YYYYYYYYYY\*SOS,电话号码,电话号码,电话号码       
实例:`003ACS*123456789012345*SOS,00000000000,00000000000,00000000000`      
终端回复:        
LENGTHCS\*YYYYYYYYYY\*SOS        
实例:`0016CS*123456789012345*SOS`      
说明:设置SOS号码,发生警情时向该号码发送短信或拨打电话.
    
## 9.IP端口设置
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*IP,IP或域名,端口        
实例:`0027CS*123456789012345*IP,113.81.229.9,5900`
- 终端回复:        
该指令终端无回复,直接断开当前连接,连接新服务器.        
说明:设置连接平台的IP和端口.
    
## 10.恢复出厂设置
- 平台发送:         
LENGTHCS\*YYYYYYYYYY\*FACTORY      
实例:`001ACS*123456789012345*FACTORY`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*FACTORY        
实例: `001ACS*123456789012345*FACTORY`       
说明:终端恢复出厂设置.
    
## 11.设置语言和时区
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*LZ,语言,时区       
实例:`0019CS*123456789012345*LZ,1,8`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*LZ       
实例:`0015CS*123456789012345*LZ`       
说明:设置终端语言和时区.
    
## 12.SOS短信报警开关
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*SOSSMS,0或1        
实例:`001BCS*123456789012345*SOSSMS,0`  
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*SOSSMS       
实例:`0019CS*123456789012345*SOSSMS`       
说明: 设置产生SOS报警后是否向SOS号码发送短信(0:关闭,1:打开).
    
## 13.低电短信报警开关
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*LOWBAT,0或1       
实例:`001BCS*123456789012345*LOWBAT,1` 
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*LOWBAT       
实例:`0019CS*123456789012345*LOWBAT`       
说明: 设置产生低点报警后是否向中心号码发送短信(0:关闭,1:打开).  
    
## 14.APN设置
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*APN,APN名字,用户名,密码,用户数据        
实例:`0024CS*123456789012345*APN,cmnet,,,46000`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*APN        
实例:`0014CS*123456789012345*APN`        
说明: 设置终端APN参数
    
## 15.短信权限控制
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*ANY,0或者1       
实例:`0018CS*123456789012345*ANY,0`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*ANY        
实例:`0016CS*123456789012345*ANY`        
说明: 设置终端短信控制权限. 
    
## 16.参数查询
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*TS       
实例:`0015CS*123456789012345*TS`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*TS,软件版本号;设备ID; IP;IMEI;端口;中心号码;辅助中心号码;SOS1号码;SOS2号码;SOS3号码;上报间隔; 电池电量; 语言;时区;卫星个数;GSM信号强度;LED开关;密码       
说明: 查询终端参数.        
实例: 
```
00E7CS*123456789012345*TS,ver:G29_BASE_V1.00_2014.04.24_09.47.23;
"ID:123456789012345;
IMEI:43353453543;
url:113.81.229.9;
port:5900;
center:;
slave:;
sos1:;
sos2:;
sos3:;
upload:30S;
workmode:1;
batlevel:3;
language:1;
zone:8.00;
GPS:NO(0);
GPRS:OK(89);
LED:OFF;
pw:123456"
```
    
## 17.版本查询
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*VERNO        
实例:`0018CS*123456789012345*VERNO `
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*VERNO,版本号        
实例:`0027CS*123456789012345*VERNO,G29_BASE_V1.00_2014.04.23_17.46.49 `      
说明:查询终端软件版本.
    
## 18.重启
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*RESET        
实例:`0018CS*123456789012345*RESET`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*RESET        
实例: `0018CS*123456789012345*RESET `      
说明:终端重启.
    
## 19.定位指令
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*CR       
实例:`0015CS*123456789012345*CR`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*CR       
实例: `0015CS*123456789012345*CR`      
说明:立即唤醒终端GPS模块,连续一段时间一直处于定位状态. 
    
## 20.关机指令
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*POWEROFF       
实例:`001BCS*123456789012345*POWEROFF`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*POWEROFF       
实例: `001BCS*123456789012345*POWEROFF`      
说明:关机功能. 
    
## 21.取下手环报警开关
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*REMOVE,0或者1        
实例:`001BCS*123456789012345*REMOVE,1`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*REMOVE       
实例: `0019CS*123456789012345*REMOVE`        
说明:拆除报警开关功能.
    
## 22.找手表指令
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*FIND       
实例:`0017CS*123456789012345*FIND`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*FIND 
实例: `0017CS*123456789012345*FIND`        
说明: 发送该指令手边响铃1分钟. 
    
## 23.闹钟设置指令
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*REMIND,闹钟1,闹钟2,闹钟3       
实例:`003ECS*123456789012345*REMIND,08:10-1-1,08:10-1-2, 08:50-1-3-0111110`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*REMIND       
实例:`0019CS*123456789012345*REMIND `      
说明:
08:50为时间, 1代表开启, 3代表第三种类型 0111110代表周一到周日
第一种类型:只闹一次.
第二种类型:每天闹
第三种类型:自定义
    
## 24.电话本设置指令
- 电话簿里的号码默认是白名单，电话簿以外号码无法给手表拨打电话、发送短信       
平台发送(前面5个):        
LENGTHCS\*YYYYYYYYYY\*PHB,姓名1,号码1,姓名2,号码2,姓名3,号码3,姓名4,号码4,姓名5,号码5        
实例:`002ECS*123456789012345*PHB,597D003100320033,313131 `       
终端回复:        
LENGTHCS\*YYYYYYYYYY\*PHB        
实例:`0016CS*123456789012345*PHB`        
平台发送(后面5个):        
LENGTHCS\*YYYYYYYYYY\*PHB2,姓名6,号码6,姓名7,号码7,姓名8,号码8,姓名9,号码9,姓名10,号码10       
实例:`002ECS*123456789012345*PHB2,597D003100320033,313131`       
终端回复:        
LENGTHCS\*YYYYYYYYYY\*PHB2       
实例:`0017CS*123456789012345*PHB2`       
说明:该指令设置终端电话本.
    
## 25.语音功能
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*TK,AMR格式音频数据       
终端回复:        
LENGTHCS\*YYYYYYYYYY\*TK,接收结果      
接收结果:1—成功         0-失败 
- 终端发送:        
LENGTHCS\*YYYYYYYYYY\*TK,AMR格式音频数据       
平台回复:        
LENGTHCS\*YYYYYYYYYY\*TK,接收结果      
接收结果:1—成功         0-失败 
    
## 26.拍照
- 平台发送:      
LENGTHCS\*YYYYYYYYYY\*PHOTO      
实例:`0018CS*123456789012345*PHOTO`
- 终端发送:        
LENGTHCS\*YYYYYYYYYY\*PHOTO,图片数据       
实例:        
`0039CS*123456789012345*PHOTO,`  
- 平台回复:        
LENGTHCS\*YYYYYYYYYY\*PHOTO,接收结果        
实例:`001ACS*123456789012345*PHOTO,1`      
接收结果:1—成功         0--失败
    
## 27.免打扰时间段设置 
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*SILENCETIME,时间段,时间段,时间段,时间段      
实例:       `0039CS*123456789012345*SILENCETIME,21:10-07:30,09:00-12:00,14:00-16:00`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*SILENCETIME      
实例:`001ACS*123456789012345*SILENCETIME`      
说明: 设置免打扰时间段范围
    
## 28.音量调节
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*VOLUME,音量等级(0/1/2/3/4)       
实例:`0039CS*123456789012345*VOLUME,3`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*VOLUME      
实例:`001ACS*123456789012345*VOLUME`       
说明: 设置手表音量等级
    
## 29.屏幕亮度调节
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*BRIGHTNESS,亮度等级(0/1/2/3/4)       
实例:`0039CS*123456789012345*BRIGHTNESS,3` 
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*BRIGHTNESS       
实例:`001ACS*123456789012345*BRIGHTNESS `      
说明: 设置手表屏幕亮度等级 
    
## 30.音频播放
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*MEDIA,音频文件URL      
实例:`0039CS*123456789012345*MEDIA,url`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*MEDIA,下载结果       
实例:`001ACS*123456789012345*MEDIA,1`     
说明: 平台发送音频文件url,终端下载此音频文件并播放       
下载结果:1—成功        0— 失败   
    
## 31.查询话费流量
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*CXYELL       
实例: `0039CS*123456789012345*CXYELL`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*CXYELL,短信内容      
实例:`001ACS*123456789012345*CXYELL,运营商回复的短信内容`
    
## 32.计步功能开关
- 平台发送:        
LENGTHCS\*YYYYYYYYYY\*PEDO,开关      
实例:`0039CS*123456789012345*PEDO,1`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*PEDO       
实例:`001ACS*123456789012345*PEDO `      
       
- 说明:1—打开 0— 关闭
    
## 33.查看手表是否在线
- 平台发送：      
LENGTHCS\*YYYYYYYYYY\*PING       
实例:`0017CS*123456789012345*PING`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*PING       
实例:`0017CS*123456789012345*PING`
    
## 34.发送文本消息
- 平台发送：      
LENGTHCS\*YYYYYYYYYY\*MESSAGE,文本消息内容       
实例:`0021CS*123456789012345*MESSAGE,hello`
- 终端回复:        
LENGTHCS\*YYYYYYYYYY\*MESSAGE      
实例:`001BCS*123456789012345*MESSAGE` 
    
    
# 四.附录
## 1.附录一
名称|实例(ASII码)|说明
---|-----------|----
日期|120414|(日月年)2014年4月12日
时间|101930|(时分秒)10点19分30秒
是否定位|A|A:定位 V:未定位
纬度|22.564026|按照DD.DDDDDD格式定义,此纬度值为22.564025
纬度标识|N|N表示北纬,S表示南纬
经度|113.242329|按照DD.DDDDDD格式定义,此经度值为113.242329
经度标识|E|E表示东经,W表示西经
速度|5.21|5.21公里/小时
方向|152|方向在152度
海拔|100|单位为米
卫星个数|9|表明GPS卫星个数
GSM信号强度|100|表明当前GSM信号强度(0-100)
电量|90|当前电量等级百分比
计步数|1000|计步数为1000
翻滚次数|50|翻滚50次
终端状态|00000000|用十六进制字符串表示,含义如下:<br>高16bit表示报警,低16bit表示状态.<br>Bit位(0开始)    含义(1有效)<br>0 : 低电状态<br>1 : 出围栏状态<br>2 : 进围栏状态<br>3 : 手环状态<br>16 : SOS报警<br>17:低电报警<br>18:出围栏报警<br>19:进围栏报警<br>20:手环拆除报警
基站个数|4|上报基站个数,0表示不上报基站信息,最多6个附近基站
连接基站ta|1|GSM时延
MCC国家码|460|460代表中国
MNC网号|0|0代表中国移动,1代表中国联通
连接基站位置区域码|10133|区域码
连接基站编号|5173|基站编号
连接基站信号强度|100|信号强度
附近基站1位置区域码|10133|区域码
附近基站1编号|10133|基站编号
附近基站1信号强度|100|信号强度
...|...|...
wifi信息数量|5|wifi个数(最多5个),按信号强度排序
wifi1名字|rrr|第一个wifi信息名字
wifi1 mac地址|`1c:fa:68:13:a5:b4`|第一个wifi mac地址
wifi1 信号强度|-61|第一个wifi信号强度
...|...|...
    
## 2.附录二

拆分示例|每个字段说明
----|-----
`0039CS*123456789012345*UD,`|`LENGTH厂商*YYYYYYYYYY*UD`
220414,|日期(14年4月22日)
134652,|时间(`13:46:52`)
A,|是否定位(A:定位 V:未定位)
22.571707,|纬度
N,|纬度标识(N:北纬 S:南纬)
113.8613968,|经度
E,|经度标识(E:东经 W:西经)
0.39,|速度(0.39km/h)
213.9,|方向(方向在213.9度)
100,|海拔(100米)
7,|卫星个数(7个)
60,|GSM信号强度(60)
90,|当前电量(90%)
1000,|步数(1000步 只记录打开计步器状态下的步数 未打开计步器 步数为0)
0001000,|终端状态(例如00010000是SOS报警)
2,|基站个数(2个)
1,|GSM时延(1)
460,|MCC国家码(460)
02,|MNC网号(02代表中国移动)
9360,|连接基站位置区域码(9360)
4082,|连接基站编号(4082)
131,|连接基站信号强度(131)
9360,|附近基站1位置区域码(9360)
4092,|附近基站1编号(4092)
148,|附近基站1信号强度(148)
2,|Wifi信息数量(2)
TP-LIN1,|Wifi 1名字(TP-LINK1)
`1c:fa:68:13:a5:b4,`|Wifi1 MAC地址(`1c:fa:68:13:a5:b4`)
-61,|Wifi 1 信号强度(-61)
TP-LIN2,|Wifi 2名字(TP-LINK2)
`1c:fa:68:13:a5:b3,`|Wifi2 MAC地址(`1c:fa:68:13:a5:b3`)
-71,|Wifi 2 信号强度(-71)



    


